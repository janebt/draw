(function(t){function e(e){for(var o,s,a=e[0],l=e[1],c=e[2],f=0,m=[];f<a.length;f++)s=a[f],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&m.push(r[s][0]),r[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(m.length)m.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],o=!0,a=1;a<n.length;a++){var l=n[a];0!==r[l]&&(o=!1)}o&&(i.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},r={index:0},i=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var c=0;c<a.length;c++)e(a[c]);var u=l;i.push([0,"chunk-vendors","chunk-common"]),n()})({0:function(t,e,n){t.exports=n("5779")},"0e80":function(t,e,n){},2136:function(t,e,n){t.exports=n.p+"media/bg.6fab370c.mp3"},"2e68":function(t,e,n){"use strict";var o=n("b83a"),r=n.n(o);r.a},4108:function(t,e,n){},"458a":function(t,e,n){"use strict";var o=n("8c25"),r=n.n(o);r.a},4992:function(t,e,n){t.exports=n.p+"media/begin.2772e4d4.mp3"},5779:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],s={name:"App"},a=s,l=n("2877"),c=Object(l["a"])(a,r,i,!1,null,null,null),u=c.exports,f=n("8c4f"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"root"}},[n("header",[n("Publicity",{directives:[{name:"show",rawName:"v-show",value:!t.running,expression:"!running"}]}),n("el-button",{staticClass:"res",attrs:{type:"text"},on:{click:function(e){t.showResult=!0}}},[t._v(" 抽奖结果 ")]),n("el-button",{staticClass:"con",attrs:{type:"text"},on:{click:function(e){t.showConfig=!0}}},[t._v(" 抽奖配置 ")])],1),n("div",{class:{mask:t.showRes},attrs:{id:"main"}}),n("div",{attrs:{id:"tags"}},t._l(t.datas,(function(e){return n("ul",{key:e.key},[n("li",[n("a",{style:{color:"#fff"},attrs:{href:"javascript:void(0);"}},[t._v(" "+t._s(e.name?e.name:e.key)+" "),e.photo?n("img",{attrs:{src:e.photo,width:50,height:50}}):t._e()])])])})),0),n("transition",{attrs:{name:"bounce"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showRes,expression:"showRes"}],attrs:{id:"resbox"}},[n("p",{on:{click:function(e){t.showRes=!1}}},[t._v(t._s(t.categoryName)+"抽奖结果：")]),n("div",{staticClass:"container"},t._l(t.resArr,(function(e){return n("span",{key:e,staticClass:"itemres",class:{numberOver:!!t.photos.find((function(t){return t.id===e}))||!!t.list.find((function(t){return t.key===e}))},style:t.resCardStyle,attrs:{"data-id":e},on:{click:function(e){t.showRes=!1}}},[t.photos.find((function(t){return t.id===e}))?t._e():n("span",{staticClass:"cont"},[t.list.find((function(t){return t.key===e}))?n("span",{style:{fontSize:"40px"}},[t._v(" "+t._s(t.list.find((function(t){return t.key===e})).name)+" ")]):n("span",[t._v(" "+t._s(e)+" ")])]),t.photos.find((function(t){return t.id===e}))?n("img",{attrs:{src:t.photos.find((function(t){return t.id===e})).value,alt:"photo",width:160,height:160}}):t._e()])})),0)])]),n("el-button",{staticClass:"audio",attrs:{type:"text"},on:{click:function(){t.playAudio(!t.audioPlaying)}}},[n("i",{staticClass:"iconfont",class:[t.audioPlaying?"iconstop":"iconplay1"]})]),n("LotteryConfig",{attrs:{visible:t.showConfig},on:{"update:visible":function(e){t.showConfig=e},resetconfig:t.reloadTagCanvas}}),n("Tool",{attrs:{running:t.running,closeRes:t.closeRes},on:{toggle:t.toggle,resetConfig:t.reloadTagCanvas,getPhoto:t.getPhoto}}),n("Result",{attrs:{visible:t.showResult},on:{"update:visible":function(e){t.showResult=e}}}),n("audio",{attrs:{id:"audiobg",preload:"auto",controls:"",autoplay:"",loop:""},on:{play:t.playHandler,pause:t.pauseHandler}},[n("source",{attrs:{src:t.audioSrc}}),t._v(" 你的浏览器不支持audio标签 ")])],1)},d=[],h=(n("99af"),n("7db0"),n("d81d"),n("b0c0"),n("159b"),n("ade3")),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"c-LotteryConfig",attrs:{visible:t.visible,"append-to-body":!0,width:"390px"},on:{close:function(e){return t.$emit("update:visible",!1)}}},[n("div",{staticClass:"c-LotteryConfigtitle",attrs:{slot:"title"},slot:"title"},[n("span",{style:{fontSize:"16px",marginRight:"20px"}},[t._v(" 抽奖配置 ")]),n("el-button",{attrs:{size:"mini"},on:{click:t.addLottery}},[t._v("增加奖项")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.onSubmit}},[t._v("保存配置")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.$emit("update:visible",!1)}}},[t._v("取消")])],1),n("div",{staticClass:"container"},[n("el-form",{ref:"form",attrs:{model:t.form,size:"mini"}},[n("el-form-item",{attrs:{label:"抽奖标题"}},[n("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"抽奖总人数"}},[n("el-input",{attrs:{type:"number",min:1,step:1},model:{value:t.form.number,callback:function(e){t.$set(t.form,"number",e)},expression:"form.number"}})],1),n("el-form-item",{attrs:{label:"盲盒"}},[n("el-input",{attrs:{type:"number",min:0,step:1},model:{value:t.form.firstPrize,callback:function(e){t.$set(t.form,"firstPrize",e)},expression:"form.firstPrize"}})],1),t._l(t.storeNewLottery,(function(e){return n("el-form-item",{key:e.key,attrs:{label:e.name}},[n("el-input",{attrs:{type:"number",min:0,step:1},on:{change:function(n){t.form[e.key]=Number(n)}},model:{value:t.form[e.key],callback:function(n){t.$set(t.form,e.key,n)},expression:"form[newitem.key]"}})],1)}))],2)],1),n("el-dialog",{staticClass:"dialog-showAddLottery",attrs:{visible:t.showAddLottery,"append-to-body":!0,width:"300px"},on:{"update:visible":function(e){t.showAddLottery=e}}},[n("div",{staticClass:"add-title",attrs:{slot:"title"},slot:"title"},[t._v("增加奖项")]),n("el-form",{ref:"newLottery",attrs:{model:t.newLottery,size:"mini"}},[n("el-form-item",{attrs:{label:"奖项名称"}},[n("el-input",{model:{value:t.newLottery.name,callback:function(e){t.$set(t.newLottery,"name",e)},expression:"newLottery.name"}})],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.addHandler}},[t._v("增加奖项")]),n("el-button",{on:{click:function(e){t.showAddLottery=!1}}},[t._v("取消")])],1)],1)],1)],1)},v=[];n("ac1f"),n("1276");function g(t,e){if("string"===typeof e)return localStorage.setItem(t,e);try{localStorage.setItem(t,JSON.stringify(e))}catch(n){return n}}function b(t){var e=localStorage.getItem(t);try{return JSON.parse(e)}catch(n){return e}}function y(t){return localStorage.removeItem(t)}function w(){return localStorage.clear()}function $(t,e){if(t&&e&&t.getAttribute)return t.getAttribute("data-"+e)}var k="config",_="result",C="newLottery",x="list";function S(t){var e="";switch(t){case"firstPrize":e="盲盒";break;default:break}var n=b(C)||[],o=n.find((function(e){return e.key===t}));return o&&(e=o.name),e}n("4de4"),n("a630"),n("caad"),n("fb6a"),n("a9e3"),n("d3b7"),n("e25e"),n("2532"),n("3ca3"),n("ddb0");function j(t,e){return Array.from(new Array(e+1).keys()).slice(t)}function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;return parseInt(Math.random()*(e-t+1)+t,10)}function L(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,o=j(1,Number(t)),r=e,i=[],s=0;s<n;s++){var a=o.filter((function(t){return!r.includes(t)})),l=a[P(1,a.length)-1];i.push(l),r.push(l)}return i}var O,R,z={name:"LotteryConfig",props:{visible:Boolean},computed:{form:{get:function(){return this.$store.state.config},set:function(t){return t}},storeNewLottery:function(){return this.$store.state.newLottery}},data:function(){return{showAddLottery:!1,newLottery:{name:""}}},methods:{onSubmit:function(){var t=this;g(k,this.form),this.$store.commit("setConfig",this.form),this.$emit("update:visible",!1),this.$message({message:"保存成功",type:"success"}),this.$nextTick((function(){t.$emit("resetconfig")}))},addLottery:function(){this.showAddLottery=!0},randomField:function(){for(var t="abcdefghijklmnopqrstuvwxyz",e="",n=0;n<10;n++)e+=t.split("")[P(1,27)-1];return"".concat(e).concat(Date.now())},addHandler:function(){var t=this.randomField(),e={key:t,name:this.newLottery.name};this.$store.commit("setNewLottery",e),this.showAddLottery=!1}}},I=z,T=(n("458a"),Object(l["a"])(I,p,v,!1,null,null,null)),A=T.exports,N=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-Publicity"},[n("el-carousel",{attrs:{height:"50px",autoplay:!0,"indicator-position":"none",arrow:"never",interval:3e3}},t._l(t.message,(function(e){return n("el-carousel-item",{key:e.key},[n("div",{staticClass:"item",class:{actiname:0===e.key}},[e.title?n("span",{staticClass:"title"},[t._v(" "+t._s(e.title))]):t._e(),e.value?n("span",{staticClass:"value"},[t._v(" "+t._s(e.value)+" ")]):t._e()])])})),1)],1)},E=[],q=(n("a15b"),n("b64b"),{name:"Publicity",computed:{config:function(){return this.$store.state.config},result:function(){return this.$store.state.result},message:function(){var t=this.result,e=this.config,n=Object.keys(e),o=[{key:0,title:e.name}];return n.forEach((function(n,r){t[n]&&e[n]>0&&o.push({key:r+1,title:"幸运号码:",value:"".concat(t[n].length>0?t[n].join("、"):"暂未抽取")})})),o}}}),B=q,H=(n("2e68"),Object(l["a"])(B,N,E,!1,null,null,null)),D=H.exports,M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"tool"}},[n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.startHandler}},[t._v(t._s(t.running?"停止":"开始"))]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showRemoveoptions=!0}}},[t._v(" 重置 ")]),n("el-dialog",{staticClass:"setwat-dialog",attrs:{"append-to-body":!0,visible:t.showSetwat,width:"400px"},on:{"update:visible":function(e){t.showSetwat=e}}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px",size:"mini"}},[n("el-form-item",{attrs:{label:"抽取奖项"}},[n("el-select",{attrs:{placeholder:"请选取本次抽取的奖项"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.categorys,(function(t,e){return n("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1),t.form.category?n("el-form-item",{attrs:{label:" "}},[n("span",[t._v(" 共 "),n("span",{staticClass:"colorred"},[t._v(t._s(t.config[t.form.category]))]),t._v(" 名 ")]),n("span",{style:{marginLeft:"20px"}},[t._v(" 剩余 "),n("span",{staticClass:"colorred"},[t._v(t._s(t.remain))]),t._v(" 名 ")])]):t._e(),n("el-form-item",{attrs:{label:"抽取方式"}},[n("el-select",{attrs:{placeholder:"请选取本次抽取方式"},model:{value:t.form.mode,callback:function(e){t.$set(t.form,"mode",e)},expression:"form.mode"}},[n("el-option",{attrs:{label:"抽1人",value:1}}),n("el-option",{attrs:{label:"抽5人",value:5}}),n("el-option",{attrs:{label:"一次抽取完",value:0}}),n("el-option",{attrs:{label:"自定义",value:99}})],1)],1),99===t.form.mode?n("el-form-item",{attrs:{label:"抽取人数"}},[n("el-input",{attrs:{type:"number",clearable:!0,min:1,max:t.remain?t.remain:100,step:1},model:{value:t.form.qty,callback:function(e){t.$set(t.form,"qty",e)},expression:"form.qty"}})],1):t._e(),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("立即抽奖")]),n("el-button",{on:{click:function(e){t.showSetwat=!1}}},[t._v("取消")])],1)],1)],1),n("el-dialog",{staticClass:"import-dialog",attrs:{"append-to-body":!0,visible:t.showImport,width:"400px"},on:{"update:visible":function(e){t.showImport=e}}},[n("el-input",{attrs:{type:"textarea",rows:10,placeholder:"请输入对应的号码和名单(可直接从excel复制)，格式(号码 名字)，导入的名单将代替号码显示在抽奖中。如：\n1 张三\n2 李四\n3 王五\n\t\t\t\t"},model:{value:t.listStr,callback:function(e){t.listStr=e},expression:"listStr"}}),n("div",{staticClass:"footer"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.transformList}},[t._v("确定")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){t.showImport=!1}}},[t._v("取消")])],1)],1),n("Importphoto",{attrs:{visible:t.showImportphoto},on:{"update:visible":function(e){t.showImportphoto=e},getPhoto:function(e){return t.$emit("getPhoto")}}}),n("el-dialog",{staticClass:"c-removeoptions",attrs:{visible:t.showRemoveoptions,width:"300px","append-to-body":!0},on:{"update:visible":function(e){t.showRemoveoptions=e}}},[n("el-form",{ref:"form",attrs:{model:t.removeInfo,"label-width":"80px",size:"mini"}},[n("el-form-item",{attrs:{label:"重置选项"}},[n("el-radio-group",{model:{value:t.removeInfo.type,callback:function(e){t.$set(t.removeInfo,"type",e)},expression:"removeInfo.type"}},[n("el-radio",{attrs:{border:"",label:0}},[t._v("重置全部数据")]),n("el-radio",{attrs:{border:"",label:1}},[t._v("重置抽奖配置")]),n("el-radio",{attrs:{border:"",label:2}},[t._v("重置名单")]),n("el-radio",{attrs:{border:"",label:3}},[t._v("重置照片")]),n("el-radio",{attrs:{border:"",label:4}},[t._v("重置抽奖结果")])],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:t.resetConfig}},[t._v("确定重置")]),n("el-button",{on:{click:function(e){t.showRemoveoptions=!1}}},[t._v("取消")])],1)],1)],1)],1)},F=[],J=(n("498a"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"c-Importphoto",attrs:{visible:t.visible,"append-to-body":!0,width:"300px"},on:{close:function(e){return t.$emit("update:visible",!1)}}},[n("el-row",[n("label",{attrs:{for:"idinput"}},[t._v("抽奖号码")]),n("el-input",{attrs:{id:"idinput",size:"mini",type:"number",min:0,max:t.config.number},model:{value:t.id,callback:function(e){t.id=e},expression:"id"}})],1),n("el-row",[n("label",{attrs:{for:"idinput"}},[t._v("照片选择")]),n("span",{staticClass:"selectbg",attrs:{"data-tip":t.filename}},[n("input",{ref:"uploadinput",staticClass:"upload",attrs:{type:"file",accept:".jpg,.png"},on:{change:t.inputChange}})])]),n("el-row",{staticClass:"photo"},[n("label",[t._v("已选照片")]),t.value?n("img",{attrs:{src:t.value,alt:"img",width:140,height:140}}):n("span",[t._v("暂未选择")])]),n("el-row",[t._v(" 支持jpg和png，照片大小不能超过150kb,建议20-50kb，建议尺寸为160*160px ")]),n("el-row",{staticClass:"center"},[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.saveHandler}},[t._v("保存")]),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.$emit("update:visible",!1)}}},[t._v("取消")])],1)],1)}),W=[],K=(n("96cf"),n("1da1")),G=n("d4ec"),U="luckydraw.GuaranteeTransaction",Q=function(t){O=t.createObjectStore(U,{keyPath:"id",autoIncrement:!0}),O.createIndex("id","id",{unique:!0}),O.createIndex("name","name")},V=function(t){t.objectStoreNames.contains(U)?(t.deleteObjectStore(U),Q(t)):Q(t)},X=1,Y="luckydraw",Z=function t(){var e=this;Object(G["a"])(this,t),Object(h["a"])(this,"add",(function(t,e){var n={createdTime:Date.now(),updateTime:Date.now()};return new Promise((function(o,r){var i=R.transaction([t],"readwrite"),s=i.objectStore(t),a=s.add(Object.assign({},n,e));a.onsuccess=function(){o(!0)},a.onerror=function(t){r(t.target.error)}}))})),Object(h["a"])(this,"edit",(function(t,e,n){var o={updateTime:Date.now()};return new Promise((function(r,i){var s=R.transaction([t],"readwrite"),a=s.objectStore(t),l=a.get(e);l.onsuccess=function(){var t=l.result;for(var e in n)"undefined"!==typeof t[e]&&(t[e]=n[e]);var s=a.put(Object.assign({},t,o));s.onsuccess=function(){r(!0)},s.onerror=function(t){i(t)}}}))})),Object(h["a"])(this,"del",(function(t,e){return new Promise((function(n,o){var r=R.transaction([t],"readwrite").objectStore(t),i=r.delete(e);i.onsuccess=function(){n(!0)},i.onerror=function(t){o(t)}}))})),Object(h["a"])(this,"clear",(function(t){return new Promise((function(e,n){var o=R.transaction([t],"readwrite").objectStore(t),r=o.clear();r.onsuccess=function(){e(!0)},r.onerror=function(t){n(t)}}))})),Object(h["a"])(this,"count",(function(t){return new Promise((function(e,n){var o=R.transaction([t],"readwrite").objectStore(t),r=o.count();r.onsuccess=function(){e(r.result)},r.onerror=function(t){n(t)}}))})),Object(h["a"])(this,"get",(function(t,e){return new Promise((function(n,o){var r=R.transaction(t).objectStore(t),i=r.get(e);i.onsuccess=function(){n(i.result)},i.onerror=function(t){o(t)}}))})),Object(h["a"])(this,"getKey",(function(t,e){return new Promise((function(n,o){var r=R.transaction(t).objectStore(t),i=r.getKey(e);i.onsuccess=function(){n(i.result)},i.onerror=function(t){o(t)}}))})),Object(h["a"])(this,"getAll",(function(t){return new Promise((function(e,n){var o=R.transaction(t).objectStore(t),r=o.getAll();r.onsuccess=function(){e(r.result)},r.onerror=function(t){n(t)}}))})),Object(h["a"])(this,"onerror",(function(t){console.log("db-connection-fail",t)})),Object(h["a"])(this,"InitIndexedDB",(function(){var t=window.indexedDB.open(Y,X);t.onerror=function(t){e.onerror(t)},t.onsuccess=function(){R=t.result,console.log("db-connection-success")},t.onupgradeneeded=function(){R=event.target.result,V(R)}})),this.InitIndexedDB()},tt=new Z,et={name:"Importphoto",props:{visible:Boolean},computed:{config:{get:function(){return this.$store.state.config}}},data:function(){return{id:0,value:"",filename:"点击选择照片"}},methods:{inputChange:function(t){var e=this,n=t.target.files,o=new FormData;o.append("uploadImg",n[0]);var r=new FileReader,i=153600,s=n[0];s&&(this.filename=s.name,r.readAsDataURL(s),r.onload=function(){if(0!=i&&i<r.result.length)return e.$message.error("不允许上传大于150KB的图片");e.value=r.result})},saveHandler:function(){var t=Object(K["a"])(regeneratorRuntime.mark((function t(){var e,n,o,r,i,s=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e=this.id,n=this.value,o=Number(e),o&&!(o<=0)){t.next=4;break}return t.abrupt("return",this.$message.error("号码必须大于0的整数"));case 4:if(n){t.next=6;break}return t.abrupt("return",this.$message.error("请选择照片"));case 6:return t.next=8,tt.get(U,o);case 8:r=t.sent,i={id:o,value:n},tt[r?"edit":"add"](U,r?o:i,r?i:null).then((function(t){t?(s.$refs.uploadinput.value="",s.value="",s.filename="点击选择照片",s.$emit("update:visible",!1),s.$emit("getPhoto"),s.$message({message:"保存成功",type:"success"})):s.$message.error("保存失败")})).catch((function(t){s.$message.error(t.message)}));case 11:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()}},nt=et,ot=(n("6a50"),Object(l["a"])(nt,J,W,!1,null,null,null)),rt=ot.exports,it={props:{running:Boolean,closeRes:Function},computed:{config:{get:function(){return this.$store.state.config}},remain:function(){return this.config[this.form.category]-(this.result[this.form.category]?this.result[this.form.category].length:0)},result:function(){return this.$store.state.result},categorys:function(){var t=[];for(var e in this.config)if(this.config.hasOwnProperty(e)){var n=this.config[e];if(n>0){var o=S(e);o&&t.push({label:o,value:e})}}return t}},components:{Importphoto:rt},data:function(){return{selectedItem:"",showSetwat:!1,showImport:!1,showImportphoto:!1,showRemoveoptions:!1,removeInfo:{type:0},form:{category:"",mode:1,qty:1,allin:!1},listStr:""}},watch:{showRemoveoptions:function(t){t||(this.removeInfo.type=0)}},methods:{resetConfig:function(){var t=this,e=this.removeInfo.type;this.$confirm("此操作将重置所选数据，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){switch(e){case 0:w(),t.$store.commit("setClearStore"),tt.clear(U);break;case 1:y(k),t.$store.commit("setClearConfig");break;case 2:y(x),t.$store.commit("setClearList");break;case 3:tt.clear(U),t.$store.commit("setClearPhotos");break;case 4:y(_),t.$store.commit("setClearResult");break;default:break}t.closeRes&&t.closeRes(),t.showRemoveoptions=!1,t.$message({type:"success",message:"重置成功!"}),t.$nextTick((function(){t.$emit("resetConfig")}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},onSubmit:function(){if(!this.form.category)return this.$message.error("请选择本次抽取的奖项");if(this.remain<=0)return this.$message.error("该奖项剩余人数不足");if(99===this.form.mode){if(this.form.qty<=0)return this.$message.error("必须输入本次抽取人数");if(this.form.qty>this.remain)return this.$message.error("本次抽奖人数已超过本奖项的剩余人数")}if((1===this.form.mode||5===this.form.mode)&&this.form.mode>this.remain)return this.$message.error("本次抽奖人数已超过本奖项的剩余人数");this.showSetwat=!1,console.log(this.form),this.$emit("toggle",Object.assign({},this.form,{remain:this.remain}))},startHandler:function(){this.$emit("toggle"),this.running||(this.showSetwat=!0)},transformList:function(){var t=this,e=this.listStr;e||this.$message.error("没有数据");var n=[],o=e.split("\n");o&&o.length>0&&o.forEach((function(t){var e=t.split(/\t|\s/);if(e.length>=2){var o=Number(e[0].trim()),r=e[1].trim();o&&n.push({key:o,name:r})}})),this.$store.commit("setList",n),this.$message({message:"保存成功",type:"success"}),this.showImport=!1,this.$nextTick((function(){t.$emit("resetConfig")}))}}},st=it,at=(n("d435"),Object(l["a"])(st,M,F,!1,null,null,null)),lt=at.exports,ct=n("2136"),ut=n.n(ct),ft=n("4992"),mt=n.n(ft),dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"c-Result",attrs:{visible:t.visible,width:"600px","append-to-body":!0},on:{close:function(e){return t.$emit("update:visible",!1)}}},[n("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[n("span",{style:{fontSize:"18px"}},[t._v(" 幸运号码 ")]),n("span",{style:{fontSize:"14px",color:"#999",marginLeft:"10px"}},[t._v(" (点击号码可以删除) ")])]),t._l(t.resultList,(function(e,o){return n("div",{key:o,staticClass:"listrow",on:{click:function(n){t.deleteRes(n,e)}}},[n("span",{staticClass:"name"},[t._v(" "+t._s(e.name)+" ")]),n("span",{staticClass:"value"},[e.value&&0===e.value.length?n("span",[t._v(" 暂未抽奖 ")]):t._e(),t._l(e.value,(function(e,o){return n("span",{key:o,staticClass:"card",attrs:{"data-res":e}},[t._v(" "+t._s(e)+" ")])}))],2)])}))],2)},ht=[],pt={name:"c-Result",props:{visible:Boolean},computed:{result:{get:function(){return this.$store.state.result},set:function(t){this.$store.commit("setResult",t)}},resultList:function(){var t=[];for(var e in this.result)if(this.result.hasOwnProperty(e)){var n=this.result[e],o=S(e);t.push({label:e,name:o,value:n})}return t}},methods:{deleteRes:function(t,e){var n=this,o=$(t.target,"res");o&&this.$confirm("此操作将移除该中奖号码，确认删除?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){if(o){var t=n.result;t[e.label]=n.result[e.label].filter((function(t){return t!==Number(o)})),n.result=t,n.$message({type:"success",message:"删除成功!"})}})).catch((function(){n.$message({type:"info",message:"已取消"})}))}}},vt=pt,gt=(n("aada"),Object(l["a"])(vt,dt,ht,!1,null,null,null)),bt=gt.exports,yt={name:"App",components:{LotteryConfig:A,Publicity:D,Tool:lt,Result:bt},computed:{resCardStyle:function(){var t={fontSize:"30px"},e=this.config.number;return e<100?t.fontSize="100px":e<1e3?t.fontSize="80px":e<1e4&&(t.fontSize="60px"),t},config:{get:function(){return this.$store.state.config}},result:{get:function(){return this.$store.state.result},set:function(t){this.$store.commit("setResult",t)}},list:function(){return this.$store.state.list},allresult:function(){var t=[];for(var e in this.result)if(this.result.hasOwnProperty(e)){var n=this.result[e];t=t.concat(n)}return t},datas:function(){var t=this,e=this.config.number,n=e>=1500?500:this.config.number,o=e>1500?Math.floor(e/3):e,r=L(o,[],n),i=r.map((function(n){var o=t.list.find((function(t){return t.key===n})),r=t.photos.find((function(t){return t.id===n}));return{key:n*(e>1500?3:1),name:o?o.name:"",photo:r?r.value:""}}));return i},categoryName:function(){return S(this.category)},photos:function(){return this.$store.state.photos}},created:function(){var t=this,e=b(k);e&&this.$store.commit("setConfig",Object.assign({},e));var n=b(_);n&&this.$store.commit("setResult",n);var o=b(C);if(o){var r=this.config;o.forEach((function(e){t.$store.commit("setNewLottery",e),r[e.key]||t.$set(r,e.key,0)})),this.$store.commit("setConfig",r)}var i=b(x);i&&this.$store.commit("setList",i)},data:function(){return{running:!1,showRes:!1,showConfig:!1,showResult:!1,resArr:[],category:"",audioPlaying:!1,audioSrc:ut.a}},watch:{photos:{deep:!0,handler:function(){var t=this;this.$nextTick((function(){t.reloadTagCanvas()}))}}},mounted:function(){var t=this;this.startTagCanvas(),setTimeout((function(){t.getPhoto()}),1e3),window.addEventListener("resize",this.reportWindowSize)},beforeDestroy:function(){window.removeEventListener("resize",this.reportWindowSize)},methods:{reportWindowSize:function(){var t=this.$el.querySelector("#rootcanvas");t.parentElement&&t.parentElement.removeChild(t),this.startTagCanvas()},playHandler:function(){this.audioPlaying=!0},pauseHandler:function(){this.audioPlaying=!1},playAudio:function(t){t?this.$el.querySelector("#audiobg").play():this.$el.querySelector("#audiobg").pause()},loadAudio:function(){var t=this;this.$el.querySelector("#audiobg").load(),this.$nextTick((function(){t.$el.querySelector("#audiobg").play()}))},getPhoto:function(){var t=this;tt.getAll(U).then((function(e){e&&e.length>0&&t.$store.commit("setPhotos",e)}))},speed:function(){return[.1*Math.random()+.01,-(.1*Math.random()+.01)]},createCanvas:function(){var t=document.createElement("canvas");t.width=document.body.offsetWidth,t.height=document.body.offsetHeight,t.id="rootcanvas",this.$el.querySelector("#main").appendChild(t)},startTagCanvas:function(){this.createCanvas();var t=this.speed;window.TagCanvas.Start("rootcanvas","tags",{textColour:null,initial:t(),dragControl:1,textHeight:20,noSelect:!0,lock:"xy"})},reloadTagCanvas:function(){window.TagCanvas.Reload("rootcanvas")},closeRes:function(){this.showRes=!1},toggle:function(t){var e=this,n=this.speed,o=this.config;if(this.running)this.audioSrc=ut.a,this.loadAudio(),window.TagCanvas.SetSpeed("rootcanvas",n()),this.showRes=!0,this.running=!this.running,this.$nextTick((function(){e.reloadTagCanvas()}));else{if(this.showRes=!1,!t)return;this.audioSrc=mt.a,this.loadAudio();var r=o.number,i=t.category,s=t.mode,a=t.qty,l=t.remain,c=t.allin,u=1;1===s||5===s?u=s:0===s?u=l:99===s&&(u=a);var f=L(r,c?[]:this.allresult,u);this.resArr=f,this.category=i,this.result[i]||this.$set(this.result,i,[]);var m=this.result[i]||[],d=Object.assign({},this.result,Object(h["a"])({},i,m.concat(f)));this.result=d,window.TagCanvas.SetSpeed("rootcanvas",[5,1]),this.running=!this.running}}}},wt=yt,$t=(n("d3fd"),Object(l["a"])(wt,m,d,!1,null,null,null)),kt=$t.exports;o["default"].use(f["a"]);var _t=[{path:"/",name:"home",component:kt,meta:{page:kt}},{path:"/home",name:"home",component:kt,meta:{page:kt}}],Ct=new f["a"]({mode:"history",base:"/",routes:_t}),xt=Ct,St=(n("c740"),n("2f62"));o["default"].use(St["a"]);var jt=new St["a"].Store({state:{config:{name:"婚礼抽奖",number:150,firstPrize:1},result:{firstPrize:[]},newLottery:[],list:[],photos:[]},mutations:{setClearConfig:function(t){t.config={name:"婚礼抽奖",number:70,firstPrize:1},t.newLottery=[]},setClearList:function(t){t.list=[]},setClearPhotos:function(t){t.photos=[]},setClearResult:function(t){t.result={firstPrize:[]}},setClearStore:function(t){t.config={name:"婚礼抽奖",number:70,firstPrize:1},t.result={firstPrize:[]},t.newLottery=[],t.list=[],t.photos=[]},setConfig:function(t,e){t.config=e},setResult:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.result=e,g(_,t.result)},setNewLottery:function(t,e){t.newLottery.find((function(t){return t.name===e.name}))||(t.newLottery.push(e),g(C,t.newLottery))},setList:function(t,e){var n=t.list;e.forEach((function(t){var e=n.findIndex((function(e){return e.key===t.key}));e>-1?n[e].name=t.name:n.push(t)})),t.list=n,g(x,n)},setPhotos:function(t,e){t.photos=e}},actions:{},modules:{}}),Pt=n("5c96"),Lt=n.n(Pt);n("44fd"),n("0fae"),n("32d3");o["default"].config.productionTip=!1,o["default"].use(Lt.a),new o["default"]({router:xt,store:jt,render:function(t){return t(u)}}).$mount("#app")},"6a50":function(t,e,n){"use strict";var o=n("4108"),r=n.n(o);r.a},"8c25":function(t,e,n){},a8ef:function(t,e,n){},aada:function(t,e,n){"use strict";var o=n("0e80"),r=n.n(o);r.a},b83a:function(t,e,n){},d3fd:function(t,e,n){"use strict";var o=n("d4c2"),r=n.n(o);r.a},d435:function(t,e,n){"use strict";var o=n("a8ef"),r=n.n(o);r.a},d4c2:function(t,e,n){}});
//# sourceMappingURL=index.55967a63.js.map